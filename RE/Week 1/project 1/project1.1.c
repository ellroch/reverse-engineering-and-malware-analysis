#include <stdio.h>
#include <Windows.h>

int main(int argc, char const *argv[], char const *envp[]) {

  DWORD dwNtdllBase=0;

  __asm
  {
    xor eax, eax
    mov eax, fs:[0x30]
    mov eax, [eax+0x0c]
    mov eax, [eax+0x14]
    mov eax, [eax]
    mov eax, [eax+0x10]
    mov dwNtdllBase, eax
  }

  printf("[*] Found NTDLL Base at 0x%08x",dwNtdllBase);
  while(1){
    Sleep(360000)
  }
  return 0;
}
